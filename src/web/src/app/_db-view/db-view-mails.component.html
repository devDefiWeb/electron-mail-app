<div class="controls mb-2">
    <a
        (click)="toggleViewMode()"
        href="javascript:void(0)"
        title="Toggle Conversation/Plain View Mode"
    >
        <i [ngClass]="{
            'fa-align-justify': state.viewMode == 'conversationsView',
            'fa-align-right fa-flip-vertical': state.viewMode == 'mailsView'
        }" class="fa"></i>
    </a>
    <div class="badge ml-2">
        {{ state.viewMode == 'mailsView' ? 'mails' : 'conversations' }}<span *ngIf="state.paging.size">: {{ state.paging.end }}
        of {{ state.paging.size }}</span>
    </div>
</div>
<div class="overflow-auto">
    <!-- TODO consider using "virtual list", ie rendering only visible data -->
    <email-securely-app-db-view-mail
        *ngFor="let mailItem of state.mails[state.viewMode].slice(0, state.paging.end); trackBy: trackByMailPk"
        [attr.selected]="mailItem.mail.pk === state.selectedMailData?.listMailPk"
        [attr.data-pk]="mailItem.mail.pk"
        [mail]="mailItem.mail"
        [conversationSize]="mailItem.conversationSize"
    ></email-securely-app-db-view-mail>
    <button class="btn btn-secondary load-more my-3" *ngIf="state.paging.nextPageSize" (click)="loadMore()">
        More
        <small>(+{{ state.paging.nextPageSize }})</small>
    </button>
</div>
